<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.48" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://keyl-liucong.github.io/foundation/es6/module-loader.html"><meta property="og:site_name" content="Hello World"><meta property="og:title" content="Module 的加载实现"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-07-14T03:08:29.000Z"><meta property="og:locale" content="zh-CN"><meta property="og:locale:alternate" content="en-US"><meta property="article:author" content="阮一峰"><meta property="article:published_time" content="2019-10-23T00:00:00.000Z"><meta property="article:modified_time" content="2022-07-14T03:08:29.000Z"><title>Module 的加载实现 | Hello World</title><meta name="description" content="vuepress-theme-hope 的演示">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.c4ea5312.css">
    <link rel="modulepreload" href="/assets/app.f0487313.js"><link rel="modulepreload" href="/assets/module-loader.html.d9ae10a8.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/module-loader.html.fd5e84c6.js"><link rel="prefetch" href="/assets/index.html.2ec65bf8.js"><link rel="prefetch" href="/assets/home.html.d6fdaea8.js"><link rel="prefetch" href="/assets/intro.html.e7dc5eb8.js"><link rel="prefetch" href="/assets/slide.html.b1e31128.js"><link rel="prefetch" href="/assets/index.html.40efaff8.js"><link rel="prefetch" href="/assets/home.html.6b83ce7b.js"><link rel="prefetch" href="/assets/slide.html.c67578ce.js"><link rel="prefetch" href="/assets/rollup.html.4a589866.js"><link rel="prefetch" href="/assets/vite.html.300cfcf4.js"><link rel="prefetch" href="/assets/webpack.html.22040d27.js"><link rel="prefetch" href="/assets/index.html.5561bba6.js"><link rel="prefetch" href="/assets/disable.html.2e95c3c7.js"><link rel="prefetch" href="/assets/encrypt.html.32cacd0e.js"><link rel="prefetch" href="/assets/markdown.html.cc2fba2e.js"><link rel="prefetch" href="/assets/page.html.b5b239a3.js"><link rel="prefetch" href="/assets/CICD.html.96f88399.js"><link rel="prefetch" href="/assets/vuepress.html.2932936c.js"><link rel="prefetch" href="/assets/apis-style.html.f3124d0a.js"><link rel="prefetch" href="/assets/document-style.html.7f7520e1.js"><link rel="prefetch" href="/assets/index.html.c8821e80.js"><link rel="prefetch" href="/assets/browser-macro-knowledge.html.0c7c7942.js"><link rel="prefetch" href="/assets/execution-details-of-rendering-process.html.a0297c2e.js"><link rel="prefetch" href="/assets/execution-details-of-v8-engine.html.12d851a0.js"><link rel="prefetch" href="/assets/kernel-and-javascript-engine.html.b1acd7be.js"><link rel="prefetch" href="/assets/index.html.182daec6.js"><link rel="prefetch" href="/assets/index.html.f343dc59.js"><link rel="prefetch" href="/assets/index.html.df767feb.js"><link rel="prefetch" href="/assets/common-commands.html.c3c4c1ef.js"><link rel="prefetch" href="/assets/config-file-generic-template.html.cffc9bb7.js"><link rel="prefetch" href="/assets/config-file-params-explanation.html.070f76ea.js"><link rel="prefetch" href="/assets/deploy-https-security-auth.html.48cdc07b.js"><link rel="prefetch" href="/assets/forward-proxy-and-reverse-proxy.html.5aa3913c.js"><link rel="prefetch" href="/assets/installation-of-nginx.html.0761ebd1.js"><link rel="prefetch" href="/assets/load-balancing.html.241bf725.js"><link rel="prefetch" href="/assets/ngx-http-access-module.html.b28bdbc0.js"><link rel="prefetch" href="/assets/ngx-http-auth-basic-module.html.d80139a9.js"><link rel="prefetch" href="/assets/ngx-http-autoindex-module.html.d686cf67.js"><link rel="prefetch" href="/assets/practice-in-front-end-separation-project.html.97335f54.js"><link rel="prefetch" href="/assets/set-auto-start-after-server-reboot.html.d29e6f4b.js"><link rel="prefetch" href="/assets/traffic-limiting-modules.html.d1b6f1d0.js"><link rel="prefetch" href="/assets/uninstallation-of-nginx.html.9450b9eb.js"><link rel="prefetch" href="/assets/index.html.8e32bf26.js"><link rel="prefetch" href="/assets/index.html.2117a072.js"><link rel="prefetch" href="/assets/disable.html.929ee7a5.js"><link rel="prefetch" href="/assets/encrypt.html.1d81e7ce.js"><link rel="prefetch" href="/assets/markdown.html.01512635.js"><link rel="prefetch" href="/assets/page.html.7505942b.js"><link rel="prefetch" href="/assets/article10.html.1fa7392b.js"><link rel="prefetch" href="/assets/article11.html.172cc759.js"><link rel="prefetch" href="/assets/article12.html.7874ca34.js"><link rel="prefetch" href="/assets/article9.html.6a92fec9.js"><link rel="prefetch" href="/assets/index.html.e88db413.js"><link rel="prefetch" href="/assets/index.html.a28e5f59.js"><link rel="prefetch" href="/assets/advanced-config.html.c9d37416.js"><link rel="prefetch" href="/assets/basic-config.html.c2cfa9a9.js"><link rel="prefetch" href="/assets/core-concept.html.bc41e621.js"><link rel="prefetch" href="/assets/generic-template.html.d67b2fdf.js"><link rel="prefetch" href="/assets/performance-optimization-in-build.html.91f380d2.js"><link rel="prefetch" href="/assets/performance-optimization-in-output.html.1d3611b1.js"><link rel="prefetch" href="/assets/index.html.3d6fd2f9.js"><link rel="prefetch" href="/assets/bfc.html.ca46c579.js"><link rel="prefetch" href="/assets/box-model.html.cc465d9c.js"><link rel="prefetch" href="/assets/flexbox.html.c650e024.js"><link rel="prefetch" href="/assets/float-property.html.270fc410.js"><link rel="prefetch" href="/assets/grid.html.f4252e19.js"><link rel="prefetch" href="/assets/layout.html.59cb2847.js"><link rel="prefetch" href="/assets/length-and-units.html.7892fc49.js"><link rel="prefetch" href="/assets/position-property.html.82aad275.js"><link rel="prefetch" href="/assets/pseudo-elements-and-pseudo-classes.html.108c30c7.js"><link rel="prefetch" href="/assets/selectors-and-selector-priority.html.431f7456.js"><link rel="prefetch" href="/assets/to-be-continued.html.a90c15f9.js"><link rel="prefetch" href="/assets/ways-to-insert-css.html.b551239f.js"><link rel="prefetch" href="/assets/index.html.f5fe9721.js"><link rel="prefetch" href="/assets/array.html.45aeb431.js"><link rel="prefetch" href="/assets/arraybuffer.html.a83e09a4.js"><link rel="prefetch" href="/assets/async.html.cbd1c0ac.js"><link rel="prefetch" href="/assets/class-extends.html.fe7d13fc.js"><link rel="prefetch" href="/assets/class.html.f255ff58.js"><link rel="prefetch" href="/assets/decorator.html.586d385e.js"><link rel="prefetch" href="/assets/destructuring.html.be17fdda.js"><link rel="prefetch" href="/assets/fp.html.da2e7d3b.js"><link rel="prefetch" href="/assets/function.html.8e1e02d0.js"><link rel="prefetch" href="/assets/generator-async.html.2f23cc73.js"><link rel="prefetch" href="/assets/generator.html.946c0f00.js"><link rel="prefetch" href="/assets/intro.html.d3252f19.js"><link rel="prefetch" href="/assets/iterator.html.b0573527.js"><link rel="prefetch" href="/assets/let.html.012067f9.js"><link rel="prefetch" href="/assets/mixin.html.18dfd595.js"><link rel="prefetch" href="/assets/module.html.76b7456c.js"><link rel="prefetch" href="/assets/number.html.b5d7f9b5.js"><link rel="prefetch" href="/assets/object.html.d51e9641.js"><link rel="prefetch" href="/assets/promise.html.067b4f8d.js"><link rel="prefetch" href="/assets/proposals.html.77e1eab2.js"><link rel="prefetch" href="/assets/proxy.html.34b0dd48.js"><link rel="prefetch" href="/assets/reference.html.a7f8a4cf.js"><link rel="prefetch" href="/assets/reflect.html.f5aa1bf4.js"><link rel="prefetch" href="/assets/regex.html.bc0eadb6.js"><link rel="prefetch" href="/assets/set-map.html.acacfd55.js"><link rel="prefetch" href="/assets/simd.html.1878235e.js"><link rel="prefetch" href="/assets/spec.html.5104549d.js"><link rel="prefetch" href="/assets/string.html.e824a95b.js"><link rel="prefetch" href="/assets/style.html.8dc31751.js"><link rel="prefetch" href="/assets/symbol.html.e4abf4b8.js"><link rel="prefetch" href="/assets/index.html.d819e359.js"><link rel="prefetch" href="/assets/html-basic-structure.html.3f39db9b.js"><link rel="prefetch" href="/assets/semantic-elements.html.1a20a576.js"><link rel="prefetch" href="/assets/to-be-continued.html.25bc85fa.js"><link rel="prefetch" href="/assets/index.html.1965ff51.js"><link rel="prefetch" href="/assets/array-iteration.html.c7b041b4.js"><link rel="prefetch" href="/assets/closure.html.5f5170da.js"><link rel="prefetch" href="/assets/data-types.html.678669f5.js"><link rel="prefetch" href="/assets/event-loop.html.292a7288.js"><link rel="prefetch" href="/assets/execution-context.html.beeb615f.js"><link rel="prefetch" href="/assets/function-currying.html.a9cd8ce6.js"><link rel="prefetch" href="/assets/function-declare.html.a591a226.js"><link rel="prefetch" href="/assets/function-invocation.html.4e3f6c23.js"><link rel="prefetch" href="/assets/gc.html.e135ba5c.js"><link rel="prefetch" href="/assets/inheritance.html.f3ab7e35.js"><link rel="prefetch" href="/assets/object-iteration.html.c1e9249e.js"><link rel="prefetch" href="/assets/prototype-and-prototype-chain.html.ae680572.js"><link rel="prefetch" href="/assets/scope.html.695f5ce5.js"><link rel="prefetch" href="/assets/shallow-clone-and-deep-clone.html.683d73a2.js"><link rel="prefetch" href="/assets/stack-and-heap.html.8ed23966.js"><link rel="prefetch" href="/assets/sync-and-async.html.c884dfa8.js"><link rel="prefetch" href="/assets/this-keyword.html.766ad50c.js"><link rel="prefetch" href="/assets/to-be-continued.html.c6ce0415.js"><link rel="prefetch" href="/assets/index.html.bd719323.js"><link rel="prefetch" href="/assets/any-and-unknow.html.6fcfab41.js"><link rel="prefetch" href="/assets/array-and-tuple.html.340e1dec.js"><link rel="prefetch" href="/assets/boolean-number-string.html.944b31d2.js"><link rel="prefetch" href="/assets/data-types-introduction.html.3c3dbda7.js"><link rel="prefetch" href="/assets/enum.html.a7983d31.js"><link rel="prefetch" href="/assets/function-type.html.d4e9c8f2.js"><link rel="prefetch" href="/assets/generics.html.6ddc0a80.js"><link rel="prefetch" href="/assets/interface.html.af1d32f2.js"><link rel="prefetch" href="/assets/to-be-continued.html.62f63a2a.js"><link rel="prefetch" href="/assets/union-and-literal.html.9ce72e74.js"><link rel="prefetch" href="/assets/void-undefined-never.html.401686bd.js"><link rel="prefetch" href="/assets/index.html.072312a8.js"><link rel="prefetch" href="/assets/index.html.e449714d.js"><link rel="prefetch" href="/assets/qr-code.html.5baa60d7.js"><link rel="prefetch" href="/assets/index.html.ccc8498b.js"><link rel="prefetch" href="/assets/react-jsx.html.7b7e3e95.js"><link rel="prefetch" href="/assets/index.html.f9851fa3.js"><link rel="prefetch" href="/assets/advanced-use.html.4ce77ea8.js"><link rel="prefetch" href="/assets/basic-use.html.ed6c6ac6.js"><link rel="prefetch" href="/assets/component-render-and-update.html.0f326389.js"><link rel="prefetch" href="/assets/diff.html.2bfd73a8.js"><link rel="prefetch" href="/assets/reactive-data.html.af12a897.js"><link rel="prefetch" href="/assets/template-compile.html.119df9ca.js"><link rel="prefetch" href="/assets/virtual-dom-and-diff.html.e407e02a.js"><link rel="prefetch" href="/assets/vue-router.html.9541db94.js"><link rel="prefetch" href="/assets/index.html.c2357cc8.js"><link rel="prefetch" href="/assets/branch.html.7eab01a7.js"><link rel="prefetch" href="/assets/change.html.7bd30e1f.js"><link rel="prefetch" href="/assets/create-repo.html.76d88758.js"><link rel="prefetch" href="/assets/custom.html.0197bac9.js"><link rel="prefetch" href="/assets/gitLFS.html.b459a28b.js"><link rel="prefetch" href="/assets/ignore.html.d9d2cdd0.js"><link rel="prefetch" href="/assets/install.html.354c5cd1.js"><link rel="prefetch" href="/assets/intro.html.0a03a93c.js"><link rel="prefetch" href="/assets/recall.html.a948a502.js"><link rel="prefetch" href="/assets/remote.html.e90194f7.js"><link rel="prefetch" href="/assets/reset.html.a58221a6.js"><link rel="prefetch" href="/assets/server.html.2d72e314.js"><link rel="prefetch" href="/assets/status.html.c723e069.js"><link rel="prefetch" href="/assets/tag.html.315917c8.js"><link rel="prefetch" href="/assets/working-directory.html.811202ae.js"><link rel="prefetch" href="/assets/working.html.2a5ac833.js"><link rel="prefetch" href="/assets/index.html.7b57e7ea.js"><link rel="prefetch" href="/assets/deploy.html.10af6334.js"><link rel="prefetch" href="/assets/intro.html.8eb0dbd7.js"><link rel="prefetch" href="/assets/pages.html.c8ac69d6.js"><link rel="prefetch" href="/assets/pr.html.b85fbb6b.js"><link rel="prefetch" href="/assets/semantic.html.ade7ed05.js"><link rel="prefetch" href="/assets/speedup.html.ad71c57c.js"><link rel="prefetch" href="/assets/token.html.54b9452f.js"><link rel="prefetch" href="/assets/index.html.e6c62dad.js"><link rel="prefetch" href="/assets/extension.html.57e550b6.js"><link rel="prefetch" href="/assets/get-started.html.de40b812.js"><link rel="prefetch" href="/assets/install.html.d80ab7c5.js"><link rel="prefetch" href="/assets/settings.html.3384ba4e.js"><link rel="prefetch" href="/assets/shortcut-key.html.6f209411.js"><link rel="prefetch" href="/assets/simple.html.66403a02.js"><link rel="prefetch" href="/assets/ui.html.f66b9ec7.js"><link rel="prefetch" href="/assets/index.html.e1c888a9.js"><link rel="prefetch" href="/assets/code-review.html.fb9b9ff1.js"><link rel="prefetch" href="/assets/css-spec.html.5364c637.js"><link rel="prefetch" href="/assets/html-spec.html.48c0d3cb.js"><link rel="prefetch" href="/assets/javascript-spec.html.56bd488a.js"><link rel="prefetch" href="/assets/vuejs-spec.html.ea8d3166.js"><link rel="prefetch" href="/assets/index.html.da371ce5.js"><link rel="prefetch" href="/assets/git-commit-message.html.e4b6cb6f.js"><link rel="prefetch" href="/assets/git-workflow.html.4dd716cf.js"><link rel="prefetch" href="/assets/version-number.html.ab5a7290.js"><link rel="prefetch" href="/assets/article1.html.d5514dba.js"><link rel="prefetch" href="/assets/article2.html.9837cb3f.js"><link rel="prefetch" href="/assets/article3.html.43b697d4.js"><link rel="prefetch" href="/assets/article4.html.c28588f7.js"><link rel="prefetch" href="/assets/article5.html.405daa55.js"><link rel="prefetch" href="/assets/article6.html.a4318bb5.js"><link rel="prefetch" href="/assets/article7.html.c7108029.js"><link rel="prefetch" href="/assets/article8.html.f4137253.js"><link rel="prefetch" href="/assets/index.html.6a1d0b13.js"><link rel="prefetch" href="/assets/demo.html.d7a0eec3.js"><link rel="prefetch" href="/assets/page.html.46cbd8a0.js"><link rel="prefetch" href="/assets/simple-debug.html.952b9d9e.js"><link rel="prefetch" href="/assets/tag-list.html.beedeff7.js"><link rel="prefetch" href="/assets/index.html.bd4ecb4d.js"><link rel="prefetch" href="/assets/env.html.a9d7f7ae.js"><link rel="prefetch" href="/assets/file-structure.html.45075087.js"><link rel="prefetch" href="/assets/index.html.4a50a05e.js"><link rel="prefetch" href="/assets/audit.html.affb31d3.js"><link rel="prefetch" href="/assets/debug.html.7509ebec.js"><link rel="prefetch" href="/assets/interface.html.c57f58df.js"><link rel="prefetch" href="/assets/npm.html.20a7d793.js"><link rel="prefetch" href="/assets/score.html.964222cd.js"><link rel="prefetch" href="/assets/index.html.e00dcb13.js"><link rel="prefetch" href="/assets/cache.html.7988dfce.js"><link rel="prefetch" href="/assets/checkout.html.c2d5f164.js"><link rel="prefetch" href="/assets/config.html.d8c97032.js"><link rel="prefetch" href="/assets/gh-pages-deploy.html.1a242b64.js"><link rel="prefetch" href="/assets/intro.html.930bb55b.js"><link rel="prefetch" href="/assets/index.html.ee1b59d5.js"><link rel="prefetch" href="/assets/basic.html.02950acc.js"><link rel="prefetch" href="/assets/command.html.181052b3.js"><link rel="prefetch" href="/assets/customization.html.7c3789a6.js"><link rel="prefetch" href="/assets/debug.html.3ff890e4.js"><link rel="prefetch" href="/assets/edit.html.246c085c.js"><link rel="prefetch" href="/assets/extension.html.a48ad5ce.js"><link rel="prefetch" href="/assets/file.html.b0c53adc.js"><link rel="prefetch" href="/assets/git.html.8fd79151.js"><link rel="prefetch" href="/assets/intellisense.html.a60743ae.js"><link rel="prefetch" href="/assets/task.html.e0b9ef85.js"><link rel="prefetch" href="/assets/index.html.8f4f60c1.js"><link rel="prefetch" href="/assets/debug.html.699b1871.js"><link rel="prefetch" href="/assets/file-system.html.222f1a8d.js"><link rel="prefetch" href="/assets/network.html.e7b641e3.js"><link rel="prefetch" href="/assets/storage.html.6ac97f72.js"><link rel="prefetch" href="/assets/index.html.ab58a44d.js"><link rel="prefetch" href="/assets/app-config.html.7cc53b6a.js"><link rel="prefetch" href="/assets/page-config.html.fe02682e.js"><link rel="prefetch" href="/assets/sitemap-config.html.3c795122.js"><link rel="prefetch" href="/assets/index.html.bdf239c7.js"><link rel="prefetch" href="/assets/behavior.html.8c07be92.js"><link rel="prefetch" href="/assets/component.html.99a4d84c.js"><link rel="prefetch" href="/assets/intro.html.0f5c71f2.js"><link rel="prefetch" href="/assets/style.html.ce597090.js"><link rel="prefetch" href="/assets/index.html.bb127265.js"><link rel="prefetch" href="/assets/env.html.79ce5796.js"><link rel="prefetch" href="/assets/intro.html.a02f337c.js"><link rel="prefetch" href="/assets/js-support.html.453d3a9d.js"><link rel="prefetch" href="/assets/mechanism.html.837d571b.js"><link rel="prefetch" href="/assets/scene.html.e484e70b.js"><link rel="prefetch" href="/assets/update.html.66b8319f.js"><link rel="prefetch" href="/assets/index.html.958cb5ab.js"><link rel="prefetch" href="/assets/app.html.ef5b1a43.js"><link rel="prefetch" href="/assets/lifetime.html.17a8aa98.js"><link rel="prefetch" href="/assets/module.html.560bd037.js"><link rel="prefetch" href="/assets/page.html.785f128a.js"><link rel="prefetch" href="/assets/register.html.0d03e29b.js"><link rel="prefetch" href="/assets/route.html.12ea0eb0.js"><link rel="prefetch" href="/assets/run.html.6f7f0fcc.js"><link rel="prefetch" href="/assets/index.html.d50b2497.js"><link rel="prefetch" href="/assets/animation.html.0b8fc1c1.js"><link rel="prefetch" href="/assets/component.html.1d3e0432.js"><link rel="prefetch" href="/assets/condition-render.html.a939097a.js"><link rel="prefetch" href="/assets/data-bind.html.ef506b21.js"><link rel="prefetch" href="/assets/event.html.c7812db7.js"><link rel="prefetch" href="/assets/list-render.html.421833a7.js"><link rel="prefetch" href="/assets/model.html.7a57daea.js"><link rel="prefetch" href="/assets/rendering-cache.html.84761e74.js"><link rel="prefetch" href="/assets/resizable.html.6ef49bd7.js"><link rel="prefetch" href="/assets/selector.html.be1ebe8b.js"><link rel="prefetch" href="/assets/template.html.41e30f8c.js"><link rel="prefetch" href="/assets/wxml.html.f6a6c2dd.js"><link rel="prefetch" href="/assets/wxs-event.html.1b8c720d.js"><link rel="prefetch" href="/assets/wxs.html.7ef6489c.js"><link rel="prefetch" href="/assets/wxss.html.aac4f3ff.js"><link rel="prefetch" href="/assets/index.html.9c04c2e2.js"><link rel="prefetch" href="/assets/interact.html.6a8be2e4.js"><link rel="prefetch" href="/assets/network.html.6f9e0c88.js"><link rel="prefetch" href="/assets/route.html.3e539be2.js"><link rel="prefetch" href="/assets/storage.html.70f877b9.js"><link rel="prefetch" href="/assets/system.html.1cd25023.js"><link rel="prefetch" href="/assets/404.html.3eae9429.js"><link rel="prefetch" href="/assets/index.html.163c9151.js"><link rel="prefetch" href="/assets/index.html.569d755c.js"><link rel="prefetch" href="/assets/index.html.fdc0e395.js"><link rel="prefetch" href="/assets/index.html.01023629.js"><link rel="prefetch" href="/assets/index.html.bbe2fe0d.js"><link rel="prefetch" href="/assets/index.html.b6b5858d.js"><link rel="prefetch" href="/assets/index.html.21d9ebab.js"><link rel="prefetch" href="/assets/index.html.4e41bdbd.js"><link rel="prefetch" href="/assets/index.html.6836a335.js"><link rel="prefetch" href="/assets/index.html.2d1503f4.js"><link rel="prefetch" href="/assets/index.html.eeb68447.js"><link rel="prefetch" href="/assets/index.html.bf646891.js"><link rel="prefetch" href="/assets/index.html.82a05bed.js"><link rel="prefetch" href="/assets/index.html.2a9242da.js"><link rel="prefetch" href="/assets/index.html.057b33a6.js"><link rel="prefetch" href="/assets/index.html.305c1058.js"><link rel="prefetch" href="/assets/index.html.915effaf.js"><link rel="prefetch" href="/assets/index.html.d3844027.js"><link rel="prefetch" href="/assets/index.html.08b4502d.js"><link rel="prefetch" href="/assets/index.html.a9ef6b11.js"><link rel="prefetch" href="/assets/index.html.ec9edcd8.js"><link rel="prefetch" href="/assets/index.html.b8d38950.js"><link rel="prefetch" href="/assets/index.html.187da453.js"><link rel="prefetch" href="/assets/index.html.bcd9bbdf.js"><link rel="prefetch" href="/assets/index.html.03b312a9.js"><link rel="prefetch" href="/assets/index.html.2953f444.js"><link rel="prefetch" href="/assets/index.html.aa4b331d.js"><link rel="prefetch" href="/assets/index.html.ff901af4.js"><link rel="prefetch" href="/assets/index.html.db2b8114.js"><link rel="prefetch" href="/assets/index.html.bd566214.js"><link rel="prefetch" href="/assets/index.html.a8c8ada2.js"><link rel="prefetch" href="/assets/index.html.c169d1ea.js"><link rel="prefetch" href="/assets/index.html.8d2d56e0.js"><link rel="prefetch" href="/assets/index.html.de5cde3d.js"><link rel="prefetch" href="/assets/index.html.93f07cce.js"><link rel="prefetch" href="/assets/index.html.d8827759.js"><link rel="prefetch" href="/assets/index.html.c9dd2a6a.js"><link rel="prefetch" href="/assets/index.html.96155eac.js"><link rel="prefetch" href="/assets/index.html.89539b5b.js"><link rel="prefetch" href="/assets/index.html.27bc3919.js"><link rel="prefetch" href="/assets/index.html.e9ae7b30.js"><link rel="prefetch" href="/assets/index.html.e7045ca3.js"><link rel="prefetch" href="/assets/index.html.cb21cdcc.js"><link rel="prefetch" href="/assets/index.html.55a4663d.js"><link rel="prefetch" href="/assets/index.html.69387c0e.js"><link rel="prefetch" href="/assets/index.html.ceca1e33.js"><link rel="prefetch" href="/assets/index.html.b8a9bc1e.js"><link rel="prefetch" href="/assets/index.html.e1b1a3ec.js"><link rel="prefetch" href="/assets/index.html.85bb4076.js"><link rel="prefetch" href="/assets/index.html.3ff96497.js"><link rel="prefetch" href="/assets/index.html.72f9a5f2.js"><link rel="prefetch" href="/assets/index.html.8eafce8f.js"><link rel="prefetch" href="/assets/index.html.91ee060f.js"><link rel="prefetch" href="/assets/index.html.7f4a3bbe.js"><link rel="prefetch" href="/assets/index.html.06c9f55b.js"><link rel="prefetch" href="/assets/index.html.16cec4bb.js"><link rel="prefetch" href="/assets/index.html.6f94ff88.js"><link rel="prefetch" href="/assets/index.html.21d4c4ec.js"><link rel="prefetch" href="/assets/index.html.fbc88041.js"><link rel="prefetch" href="/assets/index.html.093a0e3c.js"><link rel="prefetch" href="/assets/index.html.3fb9a17d.js"><link rel="prefetch" href="/assets/index.html.fcf813c0.js"><link rel="prefetch" href="/assets/index.html.f1e7a60c.js"><link rel="prefetch" href="/assets/index.html.5dac2968.js"><link rel="prefetch" href="/assets/index.html.851db52e.js"><link rel="prefetch" href="/assets/index.html.dbd9dd1c.js"><link rel="prefetch" href="/assets/index.html.ab427801.js"><link rel="prefetch" href="/assets/index.html.524a33f0.js"><link rel="prefetch" href="/assets/index.html.f94d7769.js"><link rel="prefetch" href="/assets/index.html.06673b23.js"><link rel="prefetch" href="/assets/index.html.385f2daa.js"><link rel="prefetch" href="/assets/index.html.7b1040a2.js"><link rel="prefetch" href="/assets/index.html.f55e06ef.js"><link rel="prefetch" href="/assets/index.html.8a03f0ce.js"><link rel="prefetch" href="/assets/index.html.5af793a8.js"><link rel="prefetch" href="/assets/home.html.c73312f1.js"><link rel="prefetch" href="/assets/intro.html.bd5485fc.js"><link rel="prefetch" href="/assets/slide.html.70a13ad8.js"><link rel="prefetch" href="/assets/index.html.6aadd8e7.js"><link rel="prefetch" href="/assets/home.html.d5c327fe.js"><link rel="prefetch" href="/assets/slide.html.4e899d72.js"><link rel="prefetch" href="/assets/rollup.html.6e4f3231.js"><link rel="prefetch" href="/assets/vite.html.19316c5e.js"><link rel="prefetch" href="/assets/webpack.html.4181f117.js"><link rel="prefetch" href="/assets/index.html.f65cf50f.js"><link rel="prefetch" href="/assets/disable.html.3ade628c.js"><link rel="prefetch" href="/assets/encrypt.html.5ff23346.js"><link rel="prefetch" href="/assets/markdown.html.20837bf0.js"><link rel="prefetch" href="/assets/page.html.e3e4179d.js"><link rel="prefetch" href="/assets/CICD.html.af7d73e1.js"><link rel="prefetch" href="/assets/vuepress.html.3fcf43b3.js"><link rel="prefetch" href="/assets/apis-style.html.57d1f333.js"><link rel="prefetch" href="/assets/document-style.html.d6135f65.js"><link rel="prefetch" href="/assets/index.html.5cff25b4.js"><link rel="prefetch" href="/assets/browser-macro-knowledge.html.414bc667.js"><link rel="prefetch" href="/assets/execution-details-of-rendering-process.html.ed03b15b.js"><link rel="prefetch" href="/assets/execution-details-of-v8-engine.html.a16ce206.js"><link rel="prefetch" href="/assets/kernel-and-javascript-engine.html.ef1cf3f2.js"><link rel="prefetch" href="/assets/index.html.ee25abc2.js"><link rel="prefetch" href="/assets/index.html.9f26d10c.js"><link rel="prefetch" href="/assets/index.html.2e030686.js"><link rel="prefetch" href="/assets/common-commands.html.d92eda21.js"><link rel="prefetch" href="/assets/config-file-generic-template.html.05ec026e.js"><link rel="prefetch" href="/assets/config-file-params-explanation.html.723f02d7.js"><link rel="prefetch" href="/assets/deploy-https-security-auth.html.fba874d3.js"><link rel="prefetch" href="/assets/forward-proxy-and-reverse-proxy.html.55996576.js"><link rel="prefetch" href="/assets/installation-of-nginx.html.1686f615.js"><link rel="prefetch" href="/assets/load-balancing.html.3408ec67.js"><link rel="prefetch" href="/assets/ngx-http-access-module.html.49ae7879.js"><link rel="prefetch" href="/assets/ngx-http-auth-basic-module.html.dcd05374.js"><link rel="prefetch" href="/assets/ngx-http-autoindex-module.html.e8161bc1.js"><link rel="prefetch" href="/assets/practice-in-front-end-separation-project.html.922dfa06.js"><link rel="prefetch" href="/assets/set-auto-start-after-server-reboot.html.75ed020f.js"><link rel="prefetch" href="/assets/traffic-limiting-modules.html.c6b1df21.js"><link rel="prefetch" href="/assets/uninstallation-of-nginx.html.df31f32f.js"><link rel="prefetch" href="/assets/index.html.9e42f185.js"><link rel="prefetch" href="/assets/index.html.698ef49b.js"><link rel="prefetch" href="/assets/disable.html.b0b756e8.js"><link rel="prefetch" href="/assets/encrypt.html.e3fb9c6e.js"><link rel="prefetch" href="/assets/markdown.html.959de7f2.js"><link rel="prefetch" href="/assets/page.html.4da2d6ce.js"><link rel="prefetch" href="/assets/article10.html.cd4d82fa.js"><link rel="prefetch" href="/assets/article11.html.c8b470d5.js"><link rel="prefetch" href="/assets/article12.html.1c0780b9.js"><link rel="prefetch" href="/assets/article9.html.21754e3d.js"><link rel="prefetch" href="/assets/index.html.7c5dfb3b.js"><link rel="prefetch" href="/assets/index.html.e891660f.js"><link rel="prefetch" href="/assets/advanced-config.html.797913bb.js"><link rel="prefetch" href="/assets/basic-config.html.f347e801.js"><link rel="prefetch" href="/assets/core-concept.html.6f5fc92a.js"><link rel="prefetch" href="/assets/generic-template.html.e76fe38e.js"><link rel="prefetch" href="/assets/performance-optimization-in-build.html.beea0807.js"><link rel="prefetch" href="/assets/performance-optimization-in-output.html.361e2393.js"><link rel="prefetch" href="/assets/index.html.2438b833.js"><link rel="prefetch" href="/assets/bfc.html.297117d4.js"><link rel="prefetch" href="/assets/box-model.html.f1083807.js"><link rel="prefetch" href="/assets/flexbox.html.cb9c8e9e.js"><link rel="prefetch" href="/assets/float-property.html.2678c01c.js"><link rel="prefetch" href="/assets/grid.html.87d26f4a.js"><link rel="prefetch" href="/assets/layout.html.17b51067.js"><link rel="prefetch" href="/assets/length-and-units.html.b631905b.js"><link rel="prefetch" href="/assets/position-property.html.75409706.js"><link rel="prefetch" href="/assets/pseudo-elements-and-pseudo-classes.html.ffe1dfe7.js"><link rel="prefetch" href="/assets/selectors-and-selector-priority.html.448bf104.js"><link rel="prefetch" href="/assets/to-be-continued.html.eb758247.js"><link rel="prefetch" href="/assets/ways-to-insert-css.html.c5cc5e11.js"><link rel="prefetch" href="/assets/index.html.6d3322e3.js"><link rel="prefetch" href="/assets/array.html.945a4078.js"><link rel="prefetch" href="/assets/arraybuffer.html.b8a1c006.js"><link rel="prefetch" href="/assets/async.html.61d749b0.js"><link rel="prefetch" href="/assets/class-extends.html.5389dede.js"><link rel="prefetch" href="/assets/class.html.baed2b18.js"><link rel="prefetch" href="/assets/decorator.html.b57f76e9.js"><link rel="prefetch" href="/assets/destructuring.html.a7e96489.js"><link rel="prefetch" href="/assets/fp.html.8949f693.js"><link rel="prefetch" href="/assets/function.html.23d09d39.js"><link rel="prefetch" href="/assets/generator-async.html.d6f770eb.js"><link rel="prefetch" href="/assets/generator.html.eb59e083.js"><link rel="prefetch" href="/assets/intro.html.6ef94a4d.js"><link rel="prefetch" href="/assets/iterator.html.1c3c312a.js"><link rel="prefetch" href="/assets/let.html.e36f391c.js"><link rel="prefetch" href="/assets/mixin.html.09f8f498.js"><link rel="prefetch" href="/assets/module.html.44931dae.js"><link rel="prefetch" href="/assets/number.html.96eb65f1.js"><link rel="prefetch" href="/assets/object.html.ea2b92ab.js"><link rel="prefetch" href="/assets/promise.html.839d6b45.js"><link rel="prefetch" href="/assets/proposals.html.9ba0bbc4.js"><link rel="prefetch" href="/assets/proxy.html.31a47b69.js"><link rel="prefetch" href="/assets/reference.html.feb12987.js"><link rel="prefetch" href="/assets/reflect.html.529e260f.js"><link rel="prefetch" href="/assets/regex.html.f56c36ca.js"><link rel="prefetch" href="/assets/set-map.html.d5101597.js"><link rel="prefetch" href="/assets/simd.html.6a17d4e3.js"><link rel="prefetch" href="/assets/spec.html.2d714f09.js"><link rel="prefetch" href="/assets/string.html.f56a5900.js"><link rel="prefetch" href="/assets/style.html.d7611522.js"><link rel="prefetch" href="/assets/symbol.html.e028b752.js"><link rel="prefetch" href="/assets/index.html.ab9d3672.js"><link rel="prefetch" href="/assets/html-basic-structure.html.ada0f119.js"><link rel="prefetch" href="/assets/semantic-elements.html.7337c303.js"><link rel="prefetch" href="/assets/to-be-continued.html.8458bb07.js"><link rel="prefetch" href="/assets/index.html.ec4b4fa8.js"><link rel="prefetch" href="/assets/array-iteration.html.4c8d5c6d.js"><link rel="prefetch" href="/assets/closure.html.c5a88ed0.js"><link rel="prefetch" href="/assets/data-types.html.8d89f184.js"><link rel="prefetch" href="/assets/event-loop.html.ada7ea38.js"><link rel="prefetch" href="/assets/execution-context.html.69efc2bf.js"><link rel="prefetch" href="/assets/function-currying.html.5c68b328.js"><link rel="prefetch" href="/assets/function-declare.html.dc34a5e3.js"><link rel="prefetch" href="/assets/function-invocation.html.da162b0a.js"><link rel="prefetch" href="/assets/gc.html.51bef54a.js"><link rel="prefetch" href="/assets/inheritance.html.d694b965.js"><link rel="prefetch" href="/assets/object-iteration.html.be2d68c1.js"><link rel="prefetch" href="/assets/prototype-and-prototype-chain.html.6358adec.js"><link rel="prefetch" href="/assets/scope.html.d05c28db.js"><link rel="prefetch" href="/assets/shallow-clone-and-deep-clone.html.586a322e.js"><link rel="prefetch" href="/assets/stack-and-heap.html.ebf1903e.js"><link rel="prefetch" href="/assets/sync-and-async.html.0363b8be.js"><link rel="prefetch" href="/assets/this-keyword.html.c50c7f99.js"><link rel="prefetch" href="/assets/to-be-continued.html.800a6829.js"><link rel="prefetch" href="/assets/index.html.725c0d47.js"><link rel="prefetch" href="/assets/any-and-unknow.html.b9a86b07.js"><link rel="prefetch" href="/assets/array-and-tuple.html.622e42d0.js"><link rel="prefetch" href="/assets/boolean-number-string.html.7acdc553.js"><link rel="prefetch" href="/assets/data-types-introduction.html.8a60232a.js"><link rel="prefetch" href="/assets/enum.html.cdb6d237.js"><link rel="prefetch" href="/assets/function-type.html.bf86bfbc.js"><link rel="prefetch" href="/assets/generics.html.cdd43607.js"><link rel="prefetch" href="/assets/interface.html.008600df.js"><link rel="prefetch" href="/assets/to-be-continued.html.9de9abee.js"><link rel="prefetch" href="/assets/union-and-literal.html.b860d5f4.js"><link rel="prefetch" href="/assets/void-undefined-never.html.67fe48ec.js"><link rel="prefetch" href="/assets/index.html.38ee4baf.js"><link rel="prefetch" href="/assets/index.html.da200a83.js"><link rel="prefetch" href="/assets/qr-code.html.cd31280f.js"><link rel="prefetch" href="/assets/index.html.4d5251d4.js"><link rel="prefetch" href="/assets/react-jsx.html.f9aee0d2.js"><link rel="prefetch" href="/assets/index.html.7c7e970b.js"><link rel="prefetch" href="/assets/advanced-use.html.aaede6e2.js"><link rel="prefetch" href="/assets/basic-use.html.88c70eeb.js"><link rel="prefetch" href="/assets/component-render-and-update.html.b9c603f5.js"><link rel="prefetch" href="/assets/diff.html.4db0f8dc.js"><link rel="prefetch" href="/assets/reactive-data.html.7d774bc0.js"><link rel="prefetch" href="/assets/template-compile.html.02b78aea.js"><link rel="prefetch" href="/assets/virtual-dom-and-diff.html.494de0b4.js"><link rel="prefetch" href="/assets/vue-router.html.c17cd641.js"><link rel="prefetch" href="/assets/index.html.b1369019.js"><link rel="prefetch" href="/assets/branch.html.70d147f3.js"><link rel="prefetch" href="/assets/change.html.33968edd.js"><link rel="prefetch" href="/assets/create-repo.html.038bf67d.js"><link rel="prefetch" href="/assets/custom.html.4248ab66.js"><link rel="prefetch" href="/assets/gitLFS.html.97f67646.js"><link rel="prefetch" href="/assets/ignore.html.f5929e51.js"><link rel="prefetch" href="/assets/install.html.8e0e1db7.js"><link rel="prefetch" href="/assets/intro.html.5a3a2530.js"><link rel="prefetch" href="/assets/recall.html.5ef3e3d4.js"><link rel="prefetch" href="/assets/remote.html.47ef4420.js"><link rel="prefetch" href="/assets/reset.html.68056ba1.js"><link rel="prefetch" href="/assets/server.html.62305d4c.js"><link rel="prefetch" href="/assets/status.html.abc8bcc8.js"><link rel="prefetch" href="/assets/tag.html.c4d43552.js"><link rel="prefetch" href="/assets/working-directory.html.c94609b8.js"><link rel="prefetch" href="/assets/working.html.7ff31234.js"><link rel="prefetch" href="/assets/index.html.1480c630.js"><link rel="prefetch" href="/assets/deploy.html.0d01d42e.js"><link rel="prefetch" href="/assets/intro.html.242c469d.js"><link rel="prefetch" href="/assets/pages.html.f156a18e.js"><link rel="prefetch" href="/assets/pr.html.4a020021.js"><link rel="prefetch" href="/assets/semantic.html.3d1406a5.js"><link rel="prefetch" href="/assets/speedup.html.4ab948fa.js"><link rel="prefetch" href="/assets/token.html.839c077b.js"><link rel="prefetch" href="/assets/index.html.f1d4be02.js"><link rel="prefetch" href="/assets/extension.html.10f52bb9.js"><link rel="prefetch" href="/assets/get-started.html.9eefa4eb.js"><link rel="prefetch" href="/assets/install.html.59ed7c2e.js"><link rel="prefetch" href="/assets/settings.html.14936d8c.js"><link rel="prefetch" href="/assets/shortcut-key.html.603f82fd.js"><link rel="prefetch" href="/assets/simple.html.f404de4e.js"><link rel="prefetch" href="/assets/ui.html.7304190f.js"><link rel="prefetch" href="/assets/index.html.e931f43a.js"><link rel="prefetch" href="/assets/code-review.html.8379f8da.js"><link rel="prefetch" href="/assets/css-spec.html.fc2935d4.js"><link rel="prefetch" href="/assets/html-spec.html.2e5634e6.js"><link rel="prefetch" href="/assets/javascript-spec.html.7680b910.js"><link rel="prefetch" href="/assets/vuejs-spec.html.8ef0a8f0.js"><link rel="prefetch" href="/assets/index.html.31200afd.js"><link rel="prefetch" href="/assets/git-commit-message.html.c49bae5d.js"><link rel="prefetch" href="/assets/git-workflow.html.b8d46c75.js"><link rel="prefetch" href="/assets/version-number.html.6467aca4.js"><link rel="prefetch" href="/assets/article1.html.92ec8de8.js"><link rel="prefetch" href="/assets/article2.html.027bd7ef.js"><link rel="prefetch" href="/assets/article3.html.94474d20.js"><link rel="prefetch" href="/assets/article4.html.76c63b5b.js"><link rel="prefetch" href="/assets/article5.html.2cef0697.js"><link rel="prefetch" href="/assets/article6.html.8be85808.js"><link rel="prefetch" href="/assets/article7.html.86bc106f.js"><link rel="prefetch" href="/assets/article8.html.3f653420.js"><link rel="prefetch" href="/assets/index.html.b80a515f.js"><link rel="prefetch" href="/assets/demo.html.72edec88.js"><link rel="prefetch" href="/assets/page.html.b33a86e6.js"><link rel="prefetch" href="/assets/simple-debug.html.c4550251.js"><link rel="prefetch" href="/assets/tag-list.html.bf1f1c1d.js"><link rel="prefetch" href="/assets/index.html.25f2824d.js"><link rel="prefetch" href="/assets/env.html.6315d81d.js"><link rel="prefetch" href="/assets/file-structure.html.744de03f.js"><link rel="prefetch" href="/assets/index.html.e9558ff5.js"><link rel="prefetch" href="/assets/audit.html.0c022cad.js"><link rel="prefetch" href="/assets/debug.html.3f7d24a4.js"><link rel="prefetch" href="/assets/interface.html.87b42b6f.js"><link rel="prefetch" href="/assets/npm.html.e4f27c9b.js"><link rel="prefetch" href="/assets/score.html.55c13aef.js"><link rel="prefetch" href="/assets/index.html.be4b9e81.js"><link rel="prefetch" href="/assets/cache.html.17cf0dc1.js"><link rel="prefetch" href="/assets/checkout.html.8dabcc5e.js"><link rel="prefetch" href="/assets/config.html.756aebb2.js"><link rel="prefetch" href="/assets/gh-pages-deploy.html.e8aca732.js"><link rel="prefetch" href="/assets/intro.html.7073dd32.js"><link rel="prefetch" href="/assets/index.html.87c23ce6.js"><link rel="prefetch" href="/assets/basic.html.2270b484.js"><link rel="prefetch" href="/assets/command.html.2553d58c.js"><link rel="prefetch" href="/assets/customization.html.30c9ffaa.js"><link rel="prefetch" href="/assets/debug.html.c0790e74.js"><link rel="prefetch" href="/assets/edit.html.81366c63.js"><link rel="prefetch" href="/assets/extension.html.8ae92b92.js"><link rel="prefetch" href="/assets/file.html.8cffa8f6.js"><link rel="prefetch" href="/assets/git.html.2f0fe5d1.js"><link rel="prefetch" href="/assets/intellisense.html.5a610e89.js"><link rel="prefetch" href="/assets/task.html.c27a1c07.js"><link rel="prefetch" href="/assets/index.html.804a6313.js"><link rel="prefetch" href="/assets/debug.html.d83c1bcd.js"><link rel="prefetch" href="/assets/file-system.html.e5043061.js"><link rel="prefetch" href="/assets/network.html.a38f76df.js"><link rel="prefetch" href="/assets/storage.html.c22e3281.js"><link rel="prefetch" href="/assets/index.html.2f7d6f99.js"><link rel="prefetch" href="/assets/app-config.html.bbdb1e23.js"><link rel="prefetch" href="/assets/page-config.html.900c431b.js"><link rel="prefetch" href="/assets/sitemap-config.html.e0adcc3f.js"><link rel="prefetch" href="/assets/index.html.ec9e59b0.js"><link rel="prefetch" href="/assets/behavior.html.a60423c9.js"><link rel="prefetch" href="/assets/component.html.f060cefe.js"><link rel="prefetch" href="/assets/intro.html.310df9a5.js"><link rel="prefetch" href="/assets/style.html.f6d82fb7.js"><link rel="prefetch" href="/assets/index.html.99bdd7a8.js"><link rel="prefetch" href="/assets/env.html.271fbd3a.js"><link rel="prefetch" href="/assets/intro.html.0ee49988.js"><link rel="prefetch" href="/assets/js-support.html.002a4cc7.js"><link rel="prefetch" href="/assets/mechanism.html.4c56081e.js"><link rel="prefetch" href="/assets/scene.html.65cc7481.js"><link rel="prefetch" href="/assets/update.html.9f643b34.js"><link rel="prefetch" href="/assets/index.html.f677b071.js"><link rel="prefetch" href="/assets/app.html.c13f53ab.js"><link rel="prefetch" href="/assets/lifetime.html.c8095b20.js"><link rel="prefetch" href="/assets/module.html.633a8457.js"><link rel="prefetch" href="/assets/page.html.91e602ad.js"><link rel="prefetch" href="/assets/register.html.0b5a7646.js"><link rel="prefetch" href="/assets/route.html.a82e37f9.js"><link rel="prefetch" href="/assets/run.html.873fa0cf.js"><link rel="prefetch" href="/assets/index.html.b80db9fc.js"><link rel="prefetch" href="/assets/animation.html.1d1f25d4.js"><link rel="prefetch" href="/assets/component.html.b147dac4.js"><link rel="prefetch" href="/assets/condition-render.html.450bf362.js"><link rel="prefetch" href="/assets/data-bind.html.2cc57557.js"><link rel="prefetch" href="/assets/event.html.87763ba0.js"><link rel="prefetch" href="/assets/list-render.html.27c1913e.js"><link rel="prefetch" href="/assets/model.html.cca48839.js"><link rel="prefetch" href="/assets/rendering-cache.html.45694d8b.js"><link rel="prefetch" href="/assets/resizable.html.e9623699.js"><link rel="prefetch" href="/assets/selector.html.285f9b00.js"><link rel="prefetch" href="/assets/template.html.bb18793f.js"><link rel="prefetch" href="/assets/wxml.html.309c3a08.js"><link rel="prefetch" href="/assets/wxs-event.html.593d49d5.js"><link rel="prefetch" href="/assets/wxs.html.2689f6e4.js"><link rel="prefetch" href="/assets/wxss.html.cce93e52.js"><link rel="prefetch" href="/assets/index.html.e7ca1554.js"><link rel="prefetch" href="/assets/interact.html.22efa2b5.js"><link rel="prefetch" href="/assets/network.html.2da11635.js"><link rel="prefetch" href="/assets/route.html.82afe02e.js"><link rel="prefetch" href="/assets/storage.html.ecf51b94.js"><link rel="prefetch" href="/assets/system.html.ee3a271c.js"><link rel="prefetch" href="/assets/404.html.75b9cb46.js"><link rel="prefetch" href="/assets/index.html.b818bd7f.js"><link rel="prefetch" href="/assets/index.html.f4553ced.js"><link rel="prefetch" href="/assets/index.html.e673d4c7.js"><link rel="prefetch" href="/assets/index.html.8283833f.js"><link rel="prefetch" href="/assets/index.html.5f7399e4.js"><link rel="prefetch" href="/assets/index.html.6f078f0f.js"><link rel="prefetch" href="/assets/index.html.061f4e91.js"><link rel="prefetch" href="/assets/index.html.33b1bd3c.js"><link rel="prefetch" href="/assets/index.html.8f9d150a.js"><link rel="prefetch" href="/assets/index.html.e81ed43a.js"><link rel="prefetch" href="/assets/index.html.deed425f.js"><link rel="prefetch" href="/assets/index.html.e05e09f3.js"><link rel="prefetch" href="/assets/index.html.393e1852.js"><link rel="prefetch" href="/assets/index.html.5a740ea5.js"><link rel="prefetch" href="/assets/index.html.d739aeec.js"><link rel="prefetch" href="/assets/index.html.71bf4d66.js"><link rel="prefetch" href="/assets/index.html.5aac98d1.js"><link rel="prefetch" href="/assets/index.html.e30e055a.js"><link rel="prefetch" href="/assets/index.html.1ba72a17.js"><link rel="prefetch" href="/assets/index.html.a4843c92.js"><link rel="prefetch" href="/assets/index.html.45d03f4a.js"><link rel="prefetch" href="/assets/index.html.25ea7a83.js"><link rel="prefetch" href="/assets/index.html.6beae0e0.js"><link rel="prefetch" href="/assets/index.html.388aabd7.js"><link rel="prefetch" href="/assets/index.html.e6fcd428.js"><link rel="prefetch" href="/assets/index.html.7def9d96.js"><link rel="prefetch" href="/assets/index.html.f6a326a2.js"><link rel="prefetch" href="/assets/index.html.49a497b0.js"><link rel="prefetch" href="/assets/index.html.13ef9bdb.js"><link rel="prefetch" href="/assets/index.html.637e05bb.js"><link rel="prefetch" href="/assets/index.html.2a5d8b49.js"><link rel="prefetch" href="/assets/index.html.8489b8f7.js"><link rel="prefetch" href="/assets/index.html.90982373.js"><link rel="prefetch" href="/assets/index.html.b41b7a2c.js"><link rel="prefetch" href="/assets/index.html.6d92ba48.js"><link rel="prefetch" href="/assets/index.html.e125f639.js"><link rel="prefetch" href="/assets/index.html.d517b8ed.js"><link rel="prefetch" href="/assets/index.html.f4c9f4ad.js"><link rel="prefetch" href="/assets/index.html.7f61b62f.js"><link rel="prefetch" href="/assets/index.html.6e1fad51.js"><link rel="prefetch" href="/assets/index.html.49c64bea.js"><link rel="prefetch" href="/assets/index.html.0a761ab2.js"><link rel="prefetch" href="/assets/index.html.3d90b434.js"><link rel="prefetch" href="/assets/index.html.867305d6.js"><link rel="prefetch" href="/assets/index.html.3f1c878d.js"><link rel="prefetch" href="/assets/index.html.d8ab617c.js"><link rel="prefetch" href="/assets/index.html.0fc66138.js"><link rel="prefetch" href="/assets/index.html.7a2e0f85.js"><link rel="prefetch" href="/assets/index.html.267ed2f5.js"><link rel="prefetch" href="/assets/index.html.074f8511.js"><link rel="prefetch" href="/assets/index.html.ffe6e5c8.js"><link rel="prefetch" href="/assets/index.html.43c51fd2.js"><link rel="prefetch" href="/assets/index.html.261df693.js"><link rel="prefetch" href="/assets/index.html.46cee4be.js"><link rel="prefetch" href="/assets/index.html.5abfe5e7.js"><link rel="prefetch" href="/assets/index.html.85c5f501.js"><link rel="prefetch" href="/assets/index.html.a77b5a09.js"><link rel="prefetch" href="/assets/index.html.482ce771.js"><link rel="prefetch" href="/assets/index.html.d97e26d6.js"><link rel="prefetch" href="/assets/index.html.a716c86f.js"><link rel="prefetch" href="/assets/index.html.da5d9e8a.js"><link rel="prefetch" href="/assets/index.html.b5a0737b.js"><link rel="prefetch" href="/assets/index.html.3ac089a5.js"><link rel="prefetch" href="/assets/index.html.36d46886.js"><link rel="prefetch" href="/assets/index.html.0af48b8a.js"><link rel="prefetch" href="/assets/index.html.102fd656.js"><link rel="prefetch" href="/assets/index.html.d9eb3af9.js"><link rel="prefetch" href="/assets/index.html.e53cce61.js"><link rel="prefetch" href="/assets/index.html.50533041.js"><link rel="prefetch" href="/assets/index.html.e0389a1f.js"><link rel="prefetch" href="/assets/index.html.582d9f66.js"><link rel="prefetch" href="/assets/index.html.1d7e6cd6.js"><link rel="prefetch" href="/assets/index.html.11bbafc0.js"><link rel="prefetch" href="/assets/index.html.dcaba4cf.js"><link rel="prefetch" href="/assets/404.2993a938.js"><link rel="prefetch" href="/assets/Layout.0c0aca58.js"><link rel="prefetch" href="/assets/Slide.463ac499.js"><link rel="prefetch" href="/assets/Blog.2c7fb78c.js"><link rel="prefetch" href="/assets/giscus.es.63137db5.js"><link rel="prefetch" href="/assets/auto.esm.36809f22.js"><link rel="prefetch" href="/assets/index.daae04bf.js"><link rel="prefetch" href="/assets/index.1842ee54.js"><link rel="prefetch" href="/assets/mermaid.esm.min.ee1e0284.js"><link rel="prefetch" href="/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/assets/photoswipe.esm.092fbc15.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="Hello World"><!----><span class="site-name hide-in-pad">Hello World</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="主页"><span class="icon iconfont icon-home" style=""></span>主页<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="技术规范"><span class="title"><span class="icon iconfont icon-code" style=""></span>技术规范</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/technical-specifications/version-control/" class="nav-link" aria-label="版本控制"><!---->版本控制<!----></a></li><li class="dropdown-item"><a href="/technical-specifications/code-style/" class="nav-link" aria-label="代码风格"><!---->代码风格<!----></a></li><li class="dropdown-item"><a href="/technical-specifications/apis-style.html" class="nav-link" aria-label="接口设计"><!---->接口设计<!----></a></li><li class="dropdown-item"><a href="/technical-specifications/document-style.html" class="nav-link" aria-label="文档规范"><!---->文档规范<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="基础"><span class="title"><span class="icon iconfont icon-creative" style=""></span>基础</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/foundation/html/" class="nav-link" aria-label="HTML"><span class="icon iconfont icon-html" style=""></span>HTML<!----></a></li><li class="dropdown-item"><a href="/foundation/css/" class="nav-link" aria-label="CSS"><span class="icon iconfont icon-css" style=""></span>CSS<!----></a></li><li class="dropdown-item"><a href="/foundation/es6/" class="nav-link active" aria-label="es6 入门"><span class="icon iconfont icon-es6" style=""></span>es6 入门<!----></a></li><li class="dropdown-item"><a href="/foundation/javascript/" class="nav-link" aria-label="JavaScript"><span class="icon iconfont icon-javascript" style=""></span>JavaScript<!----></a></li><li class="dropdown-item"><a href="/foundation/typescript/" class="nav-link" aria-label="TypeScript"><span class="icon iconfont icon-typescript" style=""></span>TypeScript<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="框架"><span class="title"><span class="icon iconfont icon-frame" style=""></span>框架</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/frame/vuejs/" class="nav-link" aria-label="Vue.js"><span class="icon iconfont icon-vue" style=""></span>Vue.js<!----></a></li><li class="dropdown-item"><a href="/frame/react/" class="nav-link" aria-label="React"><span class="icon iconfont icon-react" style=""></span>React<!----></a></li><li class="dropdown-item"><a href="/frame/angular/" class="nav-link" aria-label="Angular"><span class="icon iconfont icon-angular" style=""></span>Angular<!----></a></li><li class="dropdown-item"><a href="/frame/mini-app/" class="nav-link" aria-label="小程序"><span class="icon iconfont icon-mini-app" style=""></span>小程序<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="工程化"><span class="title"><span class="icon iconfont icon-list" style=""></span>工程化</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/engineering/webpack5/" class="nav-link" aria-label="Webpack5"><span class="icon iconfont icon-tool" style=""></span>Webpack5<!----></a></li><li class="dropdown-item"><a href="/engineering/vite/" class="nav-link" aria-label="vite"><span class="icon iconfont icon-note" style=""></span>vite<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="进阶"><span class="title"><span class="icon iconfont icon-advance" style=""></span>进阶</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>前端</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/advanced/performance-optimizing/" class="nav-link" aria-label="性能优化"><span class="icon iconfont icon-vite" style=""></span>性能优化<!----></a></li><li class="dropdown-subitem"><a href="/advanced/browser/" class="nav-link" aria-label="浏览器工作原理"><!---->浏览器工作原理<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>运维</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/advanced/nginx/" class="nav-link" aria-label="nginx"><!---->nginx<!----></a></li><li class="dropdown-subitem"><a href="/advanced/jenkins/" class="nav-link" aria-label="jenkins"><span class="icon iconfont icon-jenkins" style=""></span>jenkins<!----></a></li><li class="dropdown-subitem"><a href="/advanced/docker/" class="nav-link" aria-label="docker"><span class="icon iconfont icon-docker" style=""></span>docker<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="其他"><span class="title"><span class="icon iconfont icon-others" style=""></span>其他</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>工具</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/others/vscode/" class="nav-link" aria-label="VS Code"><span class="icon iconfont icon-vscode" style=""></span>VS Code<!----></a></li><li class="dropdown-subitem"><a href="/others/git/" class="nav-link" aria-label="Git"><span class="icon iconfont icon-git" style=""></span>Git<!----></a></li><li class="dropdown-subitem"><a href="/others/github" class="nav-link" aria-label="GitHub"><span class="icon iconfont icon-github" style=""></span>GitHub<!----></a></li></ul></li><li class="dropdown-item"><a href="/others//vuepress" class="nav-link" aria-label="github部署Vuepress"><span class="icon iconfont icon-edit" style=""></span>github部署Vuepress<!----></a></li><li class="dropdown-item"><a href="/others//CICD" class="nav-link" aria-label="CICD"><span class="icon iconfont icon-edit" style=""></span>CICD<!----></a></li></ul></button></div></div></nav><!----></div><div class="navbar-right"><!----><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button class="dropdown-title" type="button" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-current="page" href="/foundation/es6/module-loader.html" class="router-link-active router-link-exact-active nav-link active" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="dropdown-item"><a href="/en/" class="nav-link" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="nav-item"><a class="repo-link" href="https://github.com/keyL-liucong" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><div id="docsearch-container"></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><p class="sidebar-heading clickable active"><span class="icon iconfont icon-es6" style=""></span><a href="/foundation/es6/" class="title">es6</a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/foundation/es6/intro.html" class="nav-link sidebar-link sidebar-page" aria-label="ES6 简介"><span class="icon iconfont icon-info" style=""></span>ES6 简介<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/let.html" class="nav-link sidebar-link sidebar-page" aria-label="let 和 const 命令"><span class="icon iconfont icon-notice" style=""></span>let 和 const 命令<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/destructuring.html" class="nav-link sidebar-link sidebar-page" aria-label="变量的解构赋值"><span class="icon iconfont icon-structure" style=""></span>变量的解构赋值<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/string.html" class="nav-link sidebar-link sidebar-page" aria-label="字符串的扩展"><span class="icon iconfont icon-string" style=""></span>字符串的扩展<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/regex.html" class="nav-link sidebar-link sidebar-page" aria-label="正则的扩展"><span class="icon iconfont icon-regexp" style=""></span>正则的扩展<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/number.html" class="nav-link sidebar-link sidebar-page" aria-label="数值的扩展"><span class="icon iconfont icon-number" style=""></span>数值的扩展<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/function.html" class="nav-link sidebar-link sidebar-page" aria-label="函数的扩展"><span class="icon iconfont icon-function" style=""></span>函数的扩展<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/array.html" class="nav-link sidebar-link sidebar-page" aria-label="数组的扩展"><span class="icon iconfont icon-array" style=""></span>数组的扩展<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/object.html" class="nav-link sidebar-link sidebar-page" aria-label="对象的扩展"><span class="icon iconfont icon-object" style=""></span>对象的扩展<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/symbol.html" class="nav-link sidebar-link sidebar-page" aria-label="Symbol"><span class="icon iconfont icon-symbol" style=""></span>Symbol<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/set-map.html" class="nav-link sidebar-link sidebar-page" aria-label="Set 和 Map 数据结构"><span class="icon iconfont icon-set" style=""></span>Set 和 Map 数据结构<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/proxy.html" class="nav-link sidebar-link sidebar-page" aria-label="Proxy"><span class="icon iconfont icon-proxy" style=""></span>Proxy<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/reflect.html" class="nav-link sidebar-link sidebar-page" aria-label="Reflect"><span class="icon iconfont icon-operate" style=""></span>Reflect<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/promise.html" class="nav-link sidebar-link sidebar-page" aria-label="Promise 对象"><span class="icon iconfont icon-promise" style=""></span>Promise 对象<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/iterator.html" class="nav-link sidebar-link sidebar-page" aria-label="Iterator 和 for...of 循环"><span class="icon iconfont icon-loop" style=""></span>Iterator 和 for...of 循环<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/generator.html" class="nav-link sidebar-link sidebar-page" aria-label="Generator"><span class="icon iconfont icon-cycle" style=""></span>Generator<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/generator-async.html" class="nav-link sidebar-link sidebar-page" aria-label="Generator 异步应用"><span class="icon iconfont icon-asynchronous" style=""></span>Generator 异步应用<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/async.html" class="nav-link sidebar-link sidebar-page" aria-label="async 函数"><span class="icon iconfont icon-async" style=""></span>async 函数<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/class.html" class="nav-link sidebar-link sidebar-page" aria-label="Class 的基本语法"><span class="icon iconfont icon-class" style=""></span>Class 的基本语法<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/class-extends.html" class="nav-link sidebar-link sidebar-page" aria-label="Class 的继承"><span class="icon iconfont icon-extend" style=""></span>Class 的继承<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/decorator.html" class="nav-link sidebar-link sidebar-page" aria-label="修饰器"><span class="icon iconfont icon-at" style=""></span>修饰器<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/module.html" class="nav-link sidebar-link sidebar-page" aria-label="Module 的语法"><span class="icon iconfont icon-module" style=""></span>Module 的语法<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/foundation/es6/module-loader.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Module 的加载实现"><span class="icon iconfont icon-load" style=""></span>Module 的加载实现<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#浏览器加载" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="浏览器加载"><!---->浏览器加载<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#传统方法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="传统方法"><!---->传统方法<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#加载规则" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="加载规则"><!---->加载规则<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-模块与-commonjs-模块的差异" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ES6 模块与 CommonJS 模块的差异"><!---->ES6 模块与 CommonJS 模块的差异<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#node-js-加载" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Node.js 加载"><!---->Node.js 加载<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#概述" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="概述"><!---->概述<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#内部变量" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="内部变量"><!---->内部变量<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-模块加载-commonjs-模块" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ES6 模块加载 CommonJS 模块"><!---->ES6 模块加载 CommonJS 模块<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#commonjs-模块加载-es6-模块" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CommonJS 模块加载 ES6 模块"><!---->CommonJS 模块加载 ES6 模块<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#循环加载" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="循环加载"><!---->循环加载<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#commonjs-模块的加载原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CommonJS 模块的加载原理"><!---->CommonJS 模块的加载原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#commonjs-模块的循环加载" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CommonJS 模块的循环加载"><!---->CommonJS 模块的循环加载<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-模块的循环加载" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ES6 模块的循环加载"><!---->ES6 模块的循环加载<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-模块的转码" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ES6 模块的转码"><!---->ES6 模块的转码<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-module-transpiler" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ES6 module transpiler"><!---->ES6 module transpiler<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/foundation/es6/module-loader.html#systemjs" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SystemJS"><!---->SystemJS<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/foundation/es6/style.html" class="nav-link sidebar-link sidebar-page" aria-label="编程风格"><span class="icon iconfont icon-style" style=""></span>编程风格<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/spec.html" class="nav-link sidebar-link sidebar-page" aria-label="读懂 ECMAScript 规格"><span class="icon iconfont icon-creative" style=""></span>读懂 ECMAScript 规格<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/foundation/es6/arraybuffer.html" class="nav-link sidebar-link sidebar-page" aria-label="ArrayBuffer"><span class="icon iconfont icon-rank" style=""></span>ArrayBuffer<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-load" style=""></span>Module 的加载实现</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down" localizeddate="2019年10月23日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="author-item">阮一峰</span></span><span property="author" content="阮一峰"></span></span><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2019年10月23日</span><meta property="datePublished" content="2019-10-23T00:00:00.000Z"></span><span class="category-info" aria-label="分类🌈" data-balloon-pos="down" localizeddate="2019年10月23日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category5 clickable" role="navigation">JavaScript</li><meta property="articleSection" content="JavaScript"></ul></span><!----><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down" localizeddate="2019年10月23日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 20 分钟</span><meta property="timeRequired" content="PT20M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#浏览器加载" class="router-link-active router-link-exact-active toc-link level2">浏览器加载</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#传统方法" class="router-link-active router-link-exact-active toc-link level3">传统方法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#加载规则" class="router-link-active router-link-exact-active toc-link level3">加载规则</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-模块与-commonjs-模块的差异" class="router-link-active router-link-exact-active toc-link level2">ES6 模块与 CommonJS 模块的差异</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#node-js-加载" class="router-link-active router-link-exact-active toc-link level2">Node.js 加载</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#概述" class="router-link-active router-link-exact-active toc-link level3">概述</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#内部变量" class="router-link-active router-link-exact-active toc-link level3">内部变量</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-模块加载-commonjs-模块" class="router-link-active router-link-exact-active toc-link level3">ES6 模块加载 CommonJS 模块</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#commonjs-模块加载-es6-模块" class="router-link-active router-link-exact-active toc-link level3">CommonJS 模块加载 ES6 模块</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#循环加载" class="router-link-active router-link-exact-active toc-link level2">循环加载</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#commonjs-模块的加载原理" class="router-link-active router-link-exact-active toc-link level3">CommonJS 模块的加载原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#commonjs-模块的循环加载" class="router-link-active router-link-exact-active toc-link level3">CommonJS 模块的循环加载</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-模块的循环加载" class="router-link-active router-link-exact-active toc-link level3">ES6 模块的循环加载</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-模块的转码" class="router-link-active router-link-exact-active toc-link level2">ES6 模块的转码</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#es6-module-transpiler" class="router-link-active router-link-exact-active toc-link level3">ES6 module transpiler</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/foundation/es6/module-loader.html#systemjs" class="router-link-active router-link-exact-active toc-link level3">SystemJS</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><p>上一章介绍了模块的语法，本章介绍如何在浏览器和 Node.js 之中加载 ES6 模块，以及实际开发中经常遇到的一些问题(比如循环加载)。</p><h2 id="浏览器加载" tabindex="-1"><a class="header-anchor" href="#浏览器加载" aria-hidden="true">#</a> 浏览器加载</h2><h3 id="传统方法" tabindex="-1"><a class="header-anchor" href="#传统方法" aria-hidden="true">#</a> 传统方法</h3><p>HTML 网页中，浏览器通过 <code>&lt;script&gt;</code> 标签加载 JavaScript 脚本。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 页面内嵌的脚本 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>application/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token comment">// module code</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 外部脚本 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>application/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>path/to/myModule.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，由于浏览器脚本的默认语言是 JavaScript，因此 <code>type=&quot;application/javascript&quot;</code> 可以省略。</p><p>默认情况下，浏览器是同步加载 JavaScript 脚本，即渲染引擎遇到 <code>&lt;script&gt;</code> 标签就会停下来，等到执行完脚本，再继续向下渲染。如果是外部脚本，还必须加入脚本下载的时间。</p><p>如果脚本体积很大，下载和执行的时间就会很长，因此造成浏览器堵塞，用户会感觉到浏览器“卡死”了，没有任何响应。这显然是很不好的体验，所以浏览器允许脚本异步加载，下面就是两种异步加载的语法。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>path/to/myModule.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>path/to/myModule.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>&lt;script&gt;</code> 标签打开 <code>defer</code> 或 <code>async</code> 属性，脚本就会异步加载。渲染引擎遇到这一行命令，就会开始下载外部脚本，但不会等它下载和执行，而是直接执行后面的命令。</p><p><code>defer</code> 与 <code>async</code> 的区别是: <code>defer</code> 要等到整个页面在内存中正常渲染结束(DOM 结构完全生成，以及其他脚本执行完成)，才会执行；<code>async</code> 一旦下载完，渲染引擎就会中断渲染，执行这个脚本以后，再继续渲染。一句话，<code>defer</code> 是“渲染完再执行”，<code>async</code> 是“下载完就执行”。另外，如果有多个 <code>defer</code> 脚本，会按照它们在页面出现的顺序加载，而多个 <code>async</code> 脚本是不能保证加载顺序的。</p><h3 id="加载规则" tabindex="-1"><a class="header-anchor" href="#加载规则" aria-hidden="true">#</a> 加载规则</h3><p>浏览器加载 ES6 模块，也使用 <code>&lt;script&gt;</code> 标签，但是要加入 <code>type=&quot;module&quot;</code> 属性。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./foo.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面代码在网页中插入一个模块 <code>foo.js</code>，由于 <code>type</code> 属性设为 <code>module</code>，所以浏览器知道这是一个 ES6 模块。</p><p>浏览器对于带有 <code>type=&quot;module&quot;</code> 的 <code>&lt;script&gt;</code>，都是异步加载，不会造成堵塞浏览器，即等到整个页面渲染完，再执行模块脚本，等同于打开了 <code>&lt;script&gt;</code> 标签的 <code>defer</code> 属性。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./foo.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 等同于 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./foo.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果网页有多个 <code>&lt;script type=&quot;module&quot;&gt;</code>，它们会按照在页面出现的顺序依次执行。</p><p><code>&lt;script&gt;</code> 标签的 <code>async</code> 属性也可以打开，这时只要加载完成，渲染引擎就会中断渲染立即执行。执行完成后，再恢复渲染。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./foo.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>一旦使用了 <code>async</code> 属性，<code>&lt;script type=&quot;module&quot;&gt;</code> 就不会按照在页面出现的顺序执行，而是只要该模块加载完成，就执行该模块。</p><p>ES6 模块也允许内嵌在网页中，语法行为与加载外部脚本完全一致。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">&quot;./utils.js&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">// other code</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对于外部的模块脚本(上例是 <code>foo.js</code>)，有几点需要注意。</p><ul><li>代码是在模块作用域之中运行，而不是在全局作用域运行。模块内部的顶层变量，外部不可见。</li><li>模块脚本自动采用严格模式，不管有没有声明 <code>use strict</code>。</li><li>模块之中，可以使用 <code>import</code> 命令加载其他模块(<code>.js</code> 后缀不可省略，需要提供绝对 URL 或相对 URL)，也可以使用 <code>export</code> 命令输出对外接口。</li><li>模块之中，顶层的 <code>this</code> 关键字返回 <code>undefined</code>，而不是指向 <code>window</code>。也就是说，在模块顶层使用 <code>this</code> 关键字，是无意义的。</li><li>同一个模块如果加载多次，将只执行一次。</li></ul><p>下面是一个示例模块。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">&quot;https://example.com/js/utils.js&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x <span class="token operator">===</span> window<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>利用顶层的 <code>this</code> 等于 <code>undefined</code> 这个语法点，可以侦测当前代码是否在 ES6 模块之中。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> isNotModuleScript <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="es6-模块与-commonjs-模块的差异" tabindex="-1"><a class="header-anchor" href="#es6-模块与-commonjs-模块的差异" aria-hidden="true">#</a> ES6 模块与 CommonJS 模块的差异</h2><p>讨论 Node.js 加载 ES6 模块之前，必须了解 ES6 模块与 CommonJS 模块完全不同。</p><p>它们有两个重大差异。</p><ul><li>CommonJS 模块输出的是一个值的拷贝，ES6 模块输出的是值的引用。</li><li>CommonJS 模块是运行时加载，ES6 模块是编译时输出接口。</li></ul><p>第二个差异是因为 CommonJS 加载的是一个对象(即 <code>module.exports</code> 属性)，该对象只有在脚本运行完才会生成。而 ES6 模块不是对象，它的对外接口只是一种静态定义，在代码静态解析阶段就会生成。</p><p>下面重点解释第一个差异。</p><p>CommonJS 模块输出的是值的拷贝，也就是说，一旦输出一个值，模块内部的变化就影响不到这个值。请看下面这个模块文件 <code>lib.js</code> 的例子。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// lib.js</span>
<span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">incCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  counter<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">counter</span><span class="token operator">:</span> counter<span class="token punctuation">,</span>
  <span class="token literal-property property">incCounter</span><span class="token operator">:</span> incCounter<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码输出内部变量 <code>counter</code> 和改写这个变量的内部方法 <code>incCounter</code>。然后，在 <code>main.js</code> 里面加载这个模块。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// main.js</span>
<span class="token keyword">var</span> mod <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./lib&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mod<span class="token punctuation">.</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
mod<span class="token punctuation">.</span><span class="token function">incCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mod<span class="token punctuation">.</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码说明，<code>lib.js</code> 模块加载以后，它的内部变化就影响不到输出的 <code>mod.counter</code> 了。这是因为 <code>mod.counter</code> 是一个原始类型的值，会被缓存。除非写成一个函数，才能得到内部变动后的值。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// lib.js</span>
<span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">incCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  counter<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> counter<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">incCounter</span><span class="token operator">:</span> incCounter<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，输出的 <code>counter</code> 属性实际上是一个取值器函数。现在再执行 <code>main.js</code>，就可以正确读取内部变量 <code>counter</code> 的变动了。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">node</span> main.js
<span class="token number">3</span>
<span class="token number">4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ES6 模块的运行机制与 CommonJS 不一样。JS 引擎对脚本静态分析的时候，遇到模块加载命令 <code>import</code>，就会生成一个只读引用。等到脚本真正执行时，再根据这个只读引用，到被加载的那个模块里面去取值。换句话说，ES6 的 <code>import</code> 有点像 Unix 系统的“符号连接”，原始值变了，<code>import</code> 加载的值也会跟着变。因此，ES6 模块是动态引用，并且不会缓存值，模块里面的变量绑定其所在的模块。</p><p>还是举上面的例子。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// lib.js</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">incCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  counter<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> counter<span class="token punctuation">,</span> incCounter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./lib&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
<span class="token function">incCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码说明，ES6 模块输入的变量 <code>counter</code> 是活的，完全反应其所在模块 <code>lib.js</code> 内部的变化。</p><p>再举一个出现在 <code>export</code> 一节中的例子。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// m1.js</span>
<span class="token keyword">export</span> <span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>foo <span class="token operator">=</span> <span class="token string">&quot;baz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// m2.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./m1.js&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>m1.js</code> 的变量 <code>foo</code>，在刚加载时等于 <code>bar</code>，过了 500 毫秒，又变为等于 <code>baz</code>。</p><p>让我们看看，<code>m2.js</code> 能否正确读取这个变化。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ babel-node m2.js

bar
baz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码表明，ES6 模块不会缓存运行结果，而是动态地去被加载的模块取值，并且变量总是绑定其所在的模块。</p><p>由于 ES6 输入的模块变量，只是一个“符号连接”，所以这个变量是只读的，对它进行重新赋值会报错。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// lib.js</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> obj <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./lib&quot;</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span>prop <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// TypeError</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>main.js</code> 从 <code>lib.js</code> 输入变量 <code>obj</code>，可以对 <code>obj</code> 添加属性，但是重新赋值就会报错。因为变量 <code>obj</code> 指向的地址是只读的，不能重新赋值，这就好比 <code>main.js</code> 创造了一个名为 <code>obj</code> 的 <code>const</code> 变量。</p><p>最后，<code>export</code> 通过接口，输出的是同一个值。不同的脚本加载这个接口，得到的都是同样的实例。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// mod.js</span>
<span class="token keyword">function</span> <span class="token constant">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sum <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">show</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的脚本 <code>mod.js</code>，输出的是一个 <code>C</code> 的实例。不同的脚本加载这个模块，得到的都是同一个实例。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// x.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> c <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./mod&quot;</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// y.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> c <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./mod&quot;</span><span class="token punctuation">;</span>
c<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token string">&quot;./x&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./y&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>现在执行 <code>main.js</code>，输出的是 <code>1</code>。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ babel-node main.js
<span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这就证明了 <code>x.js</code> 和 <code>y.js</code> 加载的都是 <code>C</code> 的同一个实例。</p><h2 id="node-js-加载" tabindex="-1"><a class="header-anchor" href="#node-js-加载" aria-hidden="true">#</a> Node.js 加载</h2><h3 id="概述" tabindex="-1"><a class="header-anchor" href="#概述" aria-hidden="true">#</a> 概述</h3><p>Node.js 对 ES6 模块的处理比较麻烦，因为它有自己的 CommonJS 模块格式，与 ES6 模块格式是不兼容的。目前的解决方案是，将两者分开，ES6 模块和 CommonJS 采用各自的加载方案。</p><p>Node.js 要求 ES6 模块采用 <code>.mjs</code> 后缀文件名。也就是说，只要脚本文件里面使用 <code>import</code> 或者 <code>export</code> 命令，那么就必须采用 <code>.mjs</code> 后缀名。<code>require</code> 命令不能加载 <code>.mjs</code> 文件，会报错，只有 <code>import</code> 命令才可以加载 <code>.mjs</code> 文件。反过来，<code>.mjs</code> 文件里面也不能使用 <code>require</code> 命令，必须使用 <code>import</code>。</p><p>目前，这项功能还在试验阶段。安装 Node.js v8.5.0 或以上版本，要用 <code>--experimental-modules</code> 参数才能打开该功能。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">node</span> --experimental-modules my-app.mjs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>为了与浏览器的 <code>import</code> 加载规则相同，Node.js 的 <code>.mjs</code> 文件支持 URL 路径。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">&quot;./foo?query=1&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 加载 ./foo 传入参数 ?query=1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上面代码中，脚本路径带有参数<code>?query=1</code>，Node.js 会按 URL 规则解读。同一个脚本只要参数不同，就会被加载多次，并且保存成不同的缓存。由于这个原因，只要文件名中含有 <code>:</code>、<code>%</code>、<code>#</code>、<code>?</code>等特殊字符，最好对这些字符进行转义。</p><p>目前，Node.js 的 <code>import</code> 命令只支持加载本地模块(<code>file:</code> 协议)，不支持加载远程模块。</p><p>如果模块名不含路径，那么 <code>import</code> 命令会去 <code>node_modules</code> 目录寻找这个模块。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">&quot;baz&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;abc/123&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果模块名包含路径，那么 <code>import</code> 命令会按照路径去寻找这个名字的脚本文件。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">&quot;file:///etc/config/app.json&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./foo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./foo?search&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;../bar&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;/baz&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果脚本文件省略了后缀名，比如 <code>import &#39;./foo&#39;</code>，Node.js 会依次尝试四个后缀名: <code>./foo.mjs</code>、<code>./foo.js</code>、<code>./foo.json</code>、<code>./foo.node</code>。如果这些脚本文件都不存在，Node.js 就会去加载 <code>./foo/package.json</code> 的 <code>main</code> 字段指定的脚本。如果 <code>./foo/package.json</code> 不存在或者没有 <code>main</code> 字段，那么就会依次加载 <code>./foo/index.mjs</code>、<code>./foo/index.js</code>、<code>./foo/index.json</code>、<code>./foo/index.node</code>。如果以上四个文件还是都不存在，就会抛出错误。</p><p>最后，Node.js 的 <code>import</code> 命令是异步加载，这一点与浏览器的处理方法相同。</p><h3 id="内部变量" tabindex="-1"><a class="header-anchor" href="#内部变量" aria-hidden="true">#</a> 内部变量</h3><p>ES6 模块应该是通用的，同一个模块不用修改，就可以用在浏览器环境和服务器环境。为了达到这个目标，Node.js 规定 ES6 模块之中不能使用 CommonJS 模块的特有的一些内部变量。</p><p>首先，就是 <code>this</code> 关键字。ES6 模块之中，顶层的 <code>this</code> 指向 <code>undefined</code>；CommonJS 模块的顶层 <code>this</code> 指向当前模块，这是两者的一个重大差异。</p><p>其次，以下这些顶层变量在 ES6 模块之中都是不存在的。</p><ul><li><code>arguments</code></li><li><code>require</code></li><li><code>module</code></li><li><code>exports</code></li><li><code>__filename</code></li><li><code>__dirname</code></li></ul><p>如果您一定要使用这些变量，有一个变通方法，就是写一个 CommonJS 模块输出这些变量，然后再用 ES6 模块加载这个 CommonJS 模块。但是这样一来，该 ES6 模块就不能直接用于浏览器环境了，所以不推荐这样做。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// expose.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> __dirname <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// use.mjs</span>
<span class="token keyword">import</span> expose <span class="token keyword">from</span> <span class="token string">&quot;./expose.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> __dirname <span class="token punctuation">}</span> <span class="token operator">=</span> expose<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>expose.js</code> 是一个 CommonJS 模块，输出变量 <code>__dirname</code>，该变量在 ES6 模块之中不存在。ES6 模块加载 <code>expose.js</code>，就可以得到 <code>__dirname</code>。</p><h3 id="es6-模块加载-commonjs-模块" tabindex="-1"><a class="header-anchor" href="#es6-模块加载-commonjs-模块" aria-hidden="true">#</a> ES6 模块加载 CommonJS 模块</h3><p>CommonJS 模块的输出都定义在 <code>module.exports</code> 这个属性上面。Node.js 的 <code>import</code> 命令加载 CommonJS 模块，Node.js 会自动将 <code>module.exports</code> 属性，当作模块的默认输出，即等同于 <code>export default xxx</code>。</p><p>下面是一个 CommonJS 模块。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// a.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 等同于</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>import</code> 命令加载上面的模块，<code>module.exports</code> 会被视为默认输出，即 <code>import</code> 命令实际上输入的是这样一个对象 <code>{ default: module.exports }</code>。</p><p>所以，一共有三种写法，可以拿到 CommonJS 模块的 <code>module.exports</code>。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 写法一</span>
<span class="token keyword">import</span> baz <span class="token keyword">from</span> <span class="token string">&quot;./a&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// baz = {foo: &#39;hello&#39;, bar: &#39;world&#39;};</span>

<span class="token comment">// 写法二</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> baz <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./a&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// baz = {foo: &#39;hello&#39;, bar: &#39;world&#39;};</span>

<span class="token comment">// 写法三</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> baz <span class="token keyword">from</span> <span class="token string">&quot;./a&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// baz = {</span>
<span class="token comment">//   get default() {return module.exports;},</span>
<span class="token comment">//   get foo() {return this.default.foo}.bind(baz),</span>
<span class="token comment">//   get bar() {return this.default.bar}.bind(baz)</span>
<span class="token comment">// }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码的第三种写法，可以通过 <code>baz.default</code> 拿到 <code>module.exports</code>。<code>foo</code> 属性和 <code>bar</code> 属性就是可以通过这种方法拿到了 <code>module.exports</code>。</p><p>下面是一些例子。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// b.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token comment">// es.js</span>
<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&quot;./b&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// foo = null;</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> bar <span class="token keyword">from</span> <span class="token string">&quot;./b&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// bar = { default:null };</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>es.js</code> 采用第二种写法时，要通过 <code>bar.default</code> 这样的写法，才能拿到 <code>module.exports</code>。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// c.js</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// es.js</span>
<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&quot;./c&quot;</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> bar <span class="token keyword">from</span> <span class="token string">&quot;./c&quot;</span><span class="token punctuation">;</span>
bar<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws, bar is not a function</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>bar</code> 本身是一个对象，不能当作函数调用，只能通过 <code>bar.default</code> 调用。</p><p>CommonJS 模块的输出缓存机制，在 ES6 加载方式下依然有效。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// foo.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，对于加载 <code>foo.js</code> 的脚本，<code>module.exports</code> 将一直是 <code>123</code>，而不会变成 <code>null</code>。</p><p>由于 ES6 模块是编译时确定输出接口，CommonJS 模块是运行时确定输出接口，所以采用 <code>import</code> 命令加载 CommonJS 模块时，不允许采用下面的写法。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 不正确</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> readFile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的写法不正确，因为 <code>fs</code> 是 CommonJS 格式，只有在运行时才能确定 <code>readFile</code> 接口，而 <code>import</code> 命令要求编译时就确定这个接口。解决方法就是改为整体输入。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 正确的写法一</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> express <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 正确的写法二</span>
<span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="commonjs-模块加载-es6-模块" tabindex="-1"><a class="header-anchor" href="#commonjs-模块加载-es6-模块" aria-hidden="true">#</a> CommonJS 模块加载 ES6 模块</h3><p>CommonJS 模块加载 ES6 模块，不能使用 <code>require</code> 命令，而要使用 <code>import()</code> 函数。ES6 模块的所有输出接口，会成为输入对象的属性。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// es.mjs</span>
<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token string">&quot;my-default&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> foo<span class="token punctuation">;</span>

<span class="token comment">// cjs.js</span>
<span class="token keyword">const</span> es_namespace <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./es.mjs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// es_namespace = {</span>
<span class="token comment">//   get default() {</span>
<span class="token comment">//     ...</span>
<span class="token comment">//   }</span>
<span class="token comment">// }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>es_namespace<span class="token punctuation">.</span>default<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { bar:&#39;my-default&#39; }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>default</code> 接口变成了 <code>es_namespace.default</code> 属性。</p><p>下面是另一个例子。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// es.js</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token string">&quot;my-default&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> foo <span class="token keyword">as</span> bar <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">c</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// cjs.js</span>
<span class="token keyword">const</span> es_namespace <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./es&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// es_namespace = {</span>
<span class="token comment">//   get foo() {return foo;}</span>
<span class="token comment">//   get bar() {return foo;}</span>
<span class="token comment">//   get f() {return f;}</span>
<span class="token comment">//   get c() {return c;}</span>
<span class="token comment">// }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="循环加载" tabindex="-1"><a class="header-anchor" href="#循环加载" aria-hidden="true">#</a> 循环加载</h2><p>“循环加载”(circular dependency)指的是，<code>a</code> 脚本的执行依赖 <code>b</code> 脚本，而 <code>b</code> 脚本的执行又依赖 <code>a</code> 脚本。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// a.js</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// b.js</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通常，“循环加载”表示存在强耦合，如果处理不好，还可能导致递归加载，使得程序无法执行，因此应该避免出现。</p><p>但是实际上，这是很难避免的，尤其是依赖关系复杂的大项目，很容易出现 <code>a</code> 依赖 <code>b</code>，<code>b</code> 依赖 <code>c</code>，<code>c</code> 又依赖 <code>a</code> 这样的情况。这意味着，模块加载机制必须考虑“循环加载”的情况。</p><p>对于 JavaScript 语言来说，目前最常见的两种模块格式 CommonJS 和 ES6，处理“循环加载”的方法是不一样的，返回的结果也不一样。</p><h3 id="commonjs-模块的加载原理" tabindex="-1"><a class="header-anchor" href="#commonjs-模块的加载原理" aria-hidden="true">#</a> CommonJS 模块的加载原理</h3><p>介绍 ES6 如何处理“循环加载”之前，先介绍目前最流行的 CommonJS 模块格式的加载原理。</p><p>CommonJS 的一个模块，就是一个脚本文件。<code>require</code> 命令第一次加载该脚本，就会执行整个脚本，然后在内存生成一个对象。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;...&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">exports</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">loaded</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码就是 Node.js 内部加载模块后生成的一个对象。该对象的 <code>id</code> 属性是模块名，<code>exports</code> 属性是模块输出的各个接口，<code>loaded</code> 属性是一个布尔值，表示该模块的脚本是否执行完毕。其他还有很多属性，这里都省略了。</p><p>以后需要用到这个模块的时候，就会到 <code>exports</code> 属性上面取值。即使再次执行 <code>require</code> 命令，也不会再次执行该模块，而是到缓存之中取值。也就是说，CommonJS 模块无论加载多少次，都只会在第一次加载时运行一次，以后再加载，就返回第一次运行的结果，除非手动清除系统缓存。</p><h3 id="commonjs-模块的循环加载" tabindex="-1"><a class="header-anchor" href="#commonjs-模块的循环加载" aria-hidden="true">#</a> CommonJS 模块的循环加载</h3><p>CommonJS 模块的重要特性是加载时执行，即脚本代码在 <code>require</code> 的时候，就会全部执行。一旦出现某个模块被&quot;循环加载&quot;，就只输出已经执行的部分，还未执行的部分不会输出。</p><p>让我们来看，Node.js <a href="https://nodejs.org/api/modules.html#modules_cycles" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>里面的例子。脚本文件 <code>a.js</code> 代码如下。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./b.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;在 a.js 之中，b.done = %j&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span>done<span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a.js 执行完毕&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码之中，<code>a.js</code> 脚本先输出一个 <code>done</code> 变量，然后加载另一个脚本文件 <code>b.js</code>。注意，此时 <code>a.js</code> 代码就停在这里，等待 <code>b.js</code> 执行完毕，再往下执行。</p><p>再看 <code>b.js</code> 的代码。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./a.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;在 b.js 之中，a.done = %j&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>done<span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;b.js 执行完毕&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码之中，<code>b.js</code> 执行到第二行，就会去加载 <code>a.js</code>，这时，就发生了“循环加载”。系统会去 <code>a.js</code> 模块对应对象的 <code>exports</code> 属性取值，可是因为 <code>a.js</code> 还没有执行完，从 <code>exports</code> 属性只能取回已经执行的部分，而不是最后的值。</p><p><code>a.js</code> 已经执行的部分，只有一行。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>因此，对于 <code>b.js</code> 来说，它从 <code>a.js</code> 只输入一个变量 <code>done</code>，值为 <code>false</code>。</p><p>然后，<code>b.js</code> 接着往下执行，等到全部执行完毕，再把执行权交还给 <code>a.js</code>。于是，<code>a.js</code> 接着往下执行，直到执行完毕。我们写一个脚本 <code>main.js</code>，验证这个过程。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./a.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./b.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;在 main.js 之中, a.done=%j, b.done=%j&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>done<span class="token punctuation">,</span> b<span class="token punctuation">.</span>done<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行 <code>main.js</code>，运行结果如下。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">node</span> main.js

在 b.js 之中，a.done <span class="token operator">=</span> <span class="token boolean">false</span>
b.js 执行完毕
在 a.js 之中，b.done <span class="token operator">=</span> <span class="token boolean">true</span>
a.js 执行完毕
在 main.js 之中, a.done<span class="token operator">=</span>true, b.done<span class="token operator">=</span>true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的代码证明了两件事。一是，在 <code>b.js</code> 之中，<code>a.js</code> 没有执行完毕，只执行了第一行。二是，<code>main.js</code> 执行到第二行时，不会再次执行 <code>b.js</code>，而是输出缓存的 <code>b.js</code> 的执行结果，即它的第四行。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>总之，CommonJS 输入的是被输出值的拷贝，不是引用。</p><p>另外，由于 CommonJS 模块遇到循环加载时，返回的是当前已经执行的部分的值，而不是代码全部执行后的值，两者可能会有差异。所以，输入变量的时候，必须非常小心。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 安全的写法</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foo<span class="token punctuation">;</span> <span class="token comment">// 危险的写法</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">good</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">&quot;good&quot;</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用的是 a.foo 的最新值</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">bad</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">&quot;bad&quot;</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用的是一个部分加载时的值</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，如果发生循环加载，<code>require(&#39;a&#39;).foo</code> 的值很可能后面会被改写，改用 <code>require(&#39;a&#39;)</code> 会更保险一点。</p><h3 id="es6-模块的循环加载" tabindex="-1"><a class="header-anchor" href="#es6-模块的循环加载" aria-hidden="true">#</a> ES6 模块的循环加载</h3><p>ES6 处理“循环加载”与 CommonJS 有本质的不同。ES6 模块是动态引用，如果使用 <code>import</code> 从一个模块加载变量(即 <code>import foo from &#39;foo&#39;</code>)，那些变量不会被缓存，而是成为一个指向被加载模块的引用，需要开发者自己保证，真正取值的时候能够取到值。</p><p>请看下面这个例子。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// a.mjs</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> bar <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./b&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a.mjs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// b.mjs</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./a&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;b.mjs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>a.mjs</code> 加载 <code>b.mjs</code>，<code>b.mjs</code> 又加载 <code>a.mjs</code>，构成循环加载。执行 <code>a.mjs</code>，结果如下。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">node</span> --experimental-modules a.mjs
b.mjs
ReferenceError: foo is not defined
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，执行 <code>a.mjs</code> 以后会报错，<code>foo</code> 变量未定义，这是为什么?</p><p>让我们一行行来看，ES6 循环加载是怎么处理的。首先，执行 <code>a.mjs</code> 以后，引擎发现它加载了 <code>b.mjs</code>，因此会优先执行 <code>b.mjs</code>，然后再执行 <code>a.mjs</code>。接着，执行 <code>b.mjs</code> 的时候，已知它从 <code>a.mjs</code> 输入了 <code>foo</code> 接口，这时不会去执行 <code>a.mjs</code>，而是认为这个接口已经存在了，继续往下执行。执行到第三行 <code>console.log(foo)</code> 的时候，才发现这个接口根本没定义，因此报错。</p><p>解决这个问题的方法，就是让 <code>b.mjs</code> 运行的时候，<code>foo</code> 已经有定义了。这可以通过将 <code>foo</code> 写成函数来解决。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// a.mjs</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> bar <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./b&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a.mjs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// b.mjs</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./a&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;b.mjs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> bar <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这时再执行 <code>a.mjs</code> 就可以得到预期结果。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">node</span> --experimental-modules a.mjs
b.mjs
foo
a.mjs
bar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这是因为函数具有提升作用，在执行 <code>import {bar} from &#39;./b&#39;</code> 时，函数 <code>foo</code> 就已经有定义了，所以 <code>b.mjs</code> 加载的时候不会报错。这也意味着，如果把函数 <code>foo</code> 改写成函数表达式，也会报错。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// a.mjs</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> bar <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./b&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a.mjs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码的第四行，改成了函数表达式，就不具有提升作用，执行就会报错。</p><p>我们再来看 ES6 模块加载器<a href="https://github.com/ModuleLoader/es6-module-loader/blob/master/docs/circular-references-bindings.html" target="_blank" rel="noopener noreferrer">SystemJS<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>给出的一个例子。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// even.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> odd <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./odd&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">even</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  counter<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> n <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">odd</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// odd.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> even <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./even&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">odd</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> n <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">even</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>even.js</code> 里面的函数 <code>even</code> 有一个参数 <code>n</code>，只要不等于 0，就会减去 1，传入加载的 <code>odd()</code>。<code>odd.js</code> 也会做类似操作。</p><p>运行上面这段代码，结果如下。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>$ babel<span class="token operator">-</span>node
<span class="token operator">&gt;</span> <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> m <span class="token keyword">from</span> <span class="token string">&#39;./even.js&#39;</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> m<span class="token punctuation">.</span><span class="token function">even</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token boolean">true</span>
<span class="token operator">&gt;</span> m<span class="token punctuation">.</span>counter
<span class="token number">6</span>
<span class="token operator">&gt;</span> m<span class="token punctuation">.</span><span class="token function">even</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token boolean">true</span>
<span class="token operator">&gt;</span> m<span class="token punctuation">.</span>counter
<span class="token number">17</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，参数 <code>n</code> 从 10 变为 0 的过程中，<code>even()</code> 一共会执行 6 次，所以变量 <code>counter</code> 等于 6。第二次调用 <code>even()</code> 时，参数 <code>n</code> 从 20 变为 0，<code>even()</code> 一共会执行 11 次，加上前面的 6 次，所以变量 <code>counter</code> 等于 17。</p><p>这个例子要是改写成 CommonJS，就根本无法执行，会报错。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// even.js</span>
<span class="token keyword">var</span> odd <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./odd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>counter <span class="token operator">=</span> counter<span class="token punctuation">;</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">even</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  counter<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> n <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">odd</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// odd.js</span>
<span class="token keyword">var</span> even <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./even&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>even<span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> n <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">even</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>even.js</code> 加载 <code>odd.js</code>，而 <code>odd.js</code> 又去加载 <code>even.js</code>，形成“循环加载”。这时，执行引擎就会输出 <code>even.js</code> 已经执行的部分(不存在任何结果)，所以在 <code>odd.js</code> 之中，变量 <code>even</code> 等于 <code>undefined</code>，等到后面调用 <code>even(n - 1)</code> 就会报错。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">node</span>
<span class="token operator">&gt;</span> var m <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">&#39;./even&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> m.even<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
TypeError: even is not a <span class="token keyword">function</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="es6-模块的转码" tabindex="-1"><a class="header-anchor" href="#es6-模块的转码" aria-hidden="true">#</a> ES6 模块的转码</h2><p>浏览器目前还不支持 ES6 模块，为了现在就能使用，可以将转为 ES5 的写法。除了 Babel 可以用来转码之外，还有以下两个方法，也可以用来转码。</p><h3 id="es6-module-transpiler" tabindex="-1"><a class="header-anchor" href="#es6-module-transpiler" aria-hidden="true">#</a> ES6 module transpiler</h3><p><a href="https://github.com/esnext/es6-module-transpiler" target="_blank" rel="noopener noreferrer">ES6 module transpiler<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>是 square 公司开源的一个转码器，可以将 ES6 模块转为 CommonJS 模块或 AMD 模块的写法，从而在浏览器中使用。</p><p>首先，安装这个转码器。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g es6-module-transpiler
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后，使用 <code>compile-modules convert</code> 命令，将 ES6 模块文件转码。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>compile-modules convert file1.js file2.js
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>-o</code> 参数可以指定转码后的文件名。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>compile-modules convert -o out.js file1.js
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="systemjs" tabindex="-1"><a class="header-anchor" href="#systemjs" aria-hidden="true">#</a> SystemJS</h3><p>另一种解决方法是使用 <a href="https://github.com/systemjs/systemjs" target="_blank" rel="noopener noreferrer">SystemJS<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。它是一个垫片库(polyfill)，可以在浏览器内加载 ES6 模块、AMD 模块和 CommonJS 模块，将其转为 ES5 格式。它在后台调用的是 Google 的 Traceur 转码器。</p><p>使用时，先在网页内载入 <code>system.js</code> 文件。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>system.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后，使用 <code>System.import</code> 方法加载模块文件。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  System<span class="token punctuation">.</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">&quot;./app.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中的 <code>./app</code>，指的是当前目录下的 app.js 文件。它可以是 ES6 模块文件，<code>System.import</code> 会自动将其转码。</p><p>需要注意的是，<code>System.import</code> 使用异步加载，返回一个 Promise 对象，可以针对这个对象编程。下面是一个模块文件。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// app/es6-file.js:</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">q</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>es6 <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后，在网页内加载这个模块文件。</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  System<span class="token punctuation">.</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">&quot;app/es6-file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">m<span class="token punctuation">.</span>q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>es6<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hello</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码中，<code>System.import</code> 方法返回的是一个 Promise 对象，所以可以用 <code>then</code> 方法指定回调函数。</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/keyL-liucong/edit/main/demo/src/foundation/es6/module-loader.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/7/14 03:08:29</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: ">zzx</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/foundation/es6/module.html" class="nav-link prev" aria-label="Module 的语法"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><span class="icon iconfont icon-module" style=""></span>Module 的语法</div></a><a href="/foundation/es6/style.html" class="nav-link next" aria-label="编程风格"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">编程风格<span class="icon iconfont icon-style" style=""></span></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">默认页脚</div><div class="copyright">此部分博客采用 <a href="http://creativecommons.org/licenses/by-nc/4.0/" rel="noopener noreferrer" target="_blank">“保持署名—非商用”创意共享4.0许可证</a></div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.f0487313.js" defer></script>
  </body>
</html>
